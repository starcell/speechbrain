2023/08/01
python version : 3.8.2
pytorch version : 1.13.0+cu117
Driver Version: 525.125.06   
CUDA Version: 12.0


결과 로그 매트릭 보기
swer.txt 파일에 결과 쓰기
아래와 같이 세부분으로 결과 기록됨. 각각 SWER, WER, CER 값을 나타냄.
(%SER 또는 ALIGNMENTS로 검색)

%SWER 14.78 [ 10664 / 72164, 781 ins, 855 del, 9028 sub ]
%SER 59.89 [ 4173 / 6968 ]
Scored 6968 sentences, 0 not present in hyp.
================================================================================
ALIGNMENTS

%WER 19.12 [ 13798 / 72164, 1769 ins, 1505 del, 10524 sub ]
%SER 64.54 [ 4497 / 6968 ]
Scored 6968 sentences, 0 not present in hyp.
================================================================================
ALIGNMENTS

%CER 7.84 [ 13801 / 176080, 1299 ins, 1914 del, 10588 sub ]
%SER 59.89 [ 4173 / 6968 ]
Scored 6968 sentences, 0 not present in hyp.
================================================================================
ALIGNMENTS



2023/07/26
huggingface에 프리트레인드 파일 올리기


설치할 모듈 : transformers, git-lfs
    pip install transformers

    sudo apt-get install git-lfs
    git lfs install


로컬 컴퓨터에서 huggingface login :
    huggingface-cli login

    토큰이 필요
    로그인 한 후에 https://huggingface.co/settings/tokens로 접속하면 토큰을 발급 받을 수 있다.
    기존에 발급한 토큰이 있으면 이 사이트에서 복사해서 사용할 수 있다.

저장소 만들기 아래 명령으로 원격저장소(huggingface의 저장소)를 만들 수 있다.
    huggingface-cli repo create {프로젝트명}
    ex)
    huggingface-cli repo create kdialectspeech

원격 저장소를 clone
    git clone https://huggingface.co/npark/kdialectspeech

업로드할 파일들을 로컬저장소에 복사

복사한 후에 git으로 업로드
    git add --all
    git commit -m "message"
    git push
        -> 오류 발생

Missing or invalid credentials.
Error: connect ECONNREFUSED /tmp/vscode-git-949dfe5f18.sock
    at PipeConnectWrap.afterConnect [as oncomplete] (node:net:1247:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '/tmp/vscode-git-949dfe5f18.sock'
}
Missing or invalid credentials.
Error: connect ECONNREFUSED /tmp/vscode-git-949dfe5f18.sock
    at PipeConnectWrap.afterConnect [as oncomplete] (node:net:1247:16) {
  errno: -111,
  code: 'ECONNREFUSED',
  syscall: 'connect',
  address: '/tmp/vscode-git-949dfe5f18.sock'
}
remote: Invalid username or password.
fatal: Authentication failed for 'https://huggingface.co/npark/kdialectspeech/'

**** 해결책 *****
https://zel0rd.tistory.com/180

VS Code에서 
    설정(settings)
    git.terminal에 있는 git: terminal authentication을 끄고
    새로운 터미널을 열고 푸쉬

    username : npark@starcell.co.kr
    password : 그거

huggingfase에 저장된 모델을 불러와서 쓸 때는 아래와 같이 파이썬 프로그램에서 사용한다.
    from transformers import AutoModel
    model = Automodel.from_pretrained("JLake310/klue-bert-base-re")






2023/03/24
gs data에 마이너스 시간 데이터 있음
cc에 긴 데이터 있음 : max	318.351000

2023년 3월 5일
aidata download
강원 경상
 8%|▊         | 58937/757877 [1:37:02<16:08:32, 12.03it/s]


충청 전라 제주
 8%|▊         | 60254/795854 [1:30:21<25:07:14,  8.13it/s]



2023년 2월 23일
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
    -> 이런 경우 --device cpu 옵션으로 실행하면 실행됨. 하지만 GPU에서 실행해야 하는 경우 수정 필요



2022년 11월

SB 소스 수정(starcell branch에 수정)
추론 에러 문제 
https://github.com/speechbrain/speechbrain/issues/1590
https://github.com/speechbrain/speechbrain/issues/1784

Line 315 of https://github.com/speechbrain/speechbrain/blob/develop/speechbrain/lobes/models/transformer/TransformerASR.py

encode() return 전에 아래 코드 추가

    if self.attention_type == "RelPosMHAXL":
        # FIXME we use pos embs also on enc output
        encoder_out = encoder_out + self.positional_encoding_decoder(
            encoder_out
        )


2023/01/31
docker export [옵션] 컨테이너명|컨테이너ID > export받을 파일

ex) docker export 9959ea671300 > kdialect-speech.tar

import 방법(아래 두 가지 방법 중 하나)
$docker import kdialect-speech-container.tar kdialect-speech:202212
$cat kdialect-speech-container.tar  | docker import - kdialect-speech:202212



swer 값을 구하도록 수정
1) space_normalize_lists(list), get_swords(str)구현
    KdialectSpeech/kdialectspeech/swer.py 에 포함됨.
    KdialectSpeech/kdialectspeech를 공통 라이브러리 디렉토리로 사용

2) 위치
    recipes/KdialectSpeech/kdialectspeech/wser.py

3) train.py에서 사용
    import sys
    sys.path.append('../../kdialectspeech')
    from swer import space_normalize_lists

log : dataio/wer.py에서 %WER을 %SWER로 저장하도록 수정
    - print_wer_summary(): # 30행